//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/com/droidkit/actors/extensions/CallbackExtension.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "com/droidkit/actors/ActorRef.h"
#include "com/droidkit/actors/ActorSystem.h"
#include "com/droidkit/actors/extensions/CallbackExtension.h"
#include "java/lang/ClassLoader.h"
#include "java/lang/IllegalAccessException.h"
#include "java/lang/Throwable.h"
#include "java/lang/reflect/InvocationTargetException.h"
#include "java/lang/reflect/Method.h"
#include "java/lang/reflect/Proxy.h"
#include "java/util/HashMap.h"

@interface ComDroidkitActorsExtensionsCallbackExtension () {
 @public
  JavaUtilHashMap *proxyMap_;
  DAActorRef *self__;
}
@end

J2OBJC_FIELD_SETTER(ComDroidkitActorsExtensionsCallbackExtension, proxyMap_, JavaUtilHashMap *)
J2OBJC_FIELD_SETTER(ComDroidkitActorsExtensionsCallbackExtension, self__, DAActorRef *)

@interface ComDroidkitActorsExtensionsCallbackExtension_PerformCallback () {
 @public
  id dest_;
  JavaLangReflectMethod *method_;
  IOSObjectArray *args_;
}
- (instancetype)initWithId:(id)dest
 withJavaLangReflectMethod:(JavaLangReflectMethod *)method
         withNSObjectArray:(IOSObjectArray *)args;
@end

J2OBJC_FIELD_SETTER(ComDroidkitActorsExtensionsCallbackExtension_PerformCallback, dest_, id)
J2OBJC_FIELD_SETTER(ComDroidkitActorsExtensionsCallbackExtension_PerformCallback, method_, JavaLangReflectMethod *)
J2OBJC_FIELD_SETTER(ComDroidkitActorsExtensionsCallbackExtension_PerformCallback, args_, IOSObjectArray *)

@interface ComDroidkitActorsExtensionsCallbackExtension_$1 () {
 @public
  ComDroidkitActorsExtensionsCallbackExtension *this$0_;
  id val$src_;
}
@end

J2OBJC_FIELD_SETTER(ComDroidkitActorsExtensionsCallbackExtension_$1, this$0_, ComDroidkitActorsExtensionsCallbackExtension *)
J2OBJC_FIELD_SETTER(ComDroidkitActorsExtensionsCallbackExtension_$1, val$src_, id)

@implementation ComDroidkitActorsExtensionsCallbackExtension

- (instancetype)initWithDAActorRef:(DAActorRef *)self_ {
  if (self = [super init]) {
    ComDroidkitActorsExtensionsCallbackExtension_setAndConsume_proxyMap_(self, [[JavaUtilHashMap alloc] init]);
    ComDroidkitActorsExtensionsCallbackExtension_set_self__(self, self_);
  }
  return self;
}

- (void)preStart {
}

- (jboolean)onReceiveWithId:(id)message {
  if ([message isKindOfClass:[ComDroidkitActorsExtensionsCallbackExtension_PerformCallback class]]) {
    ComDroidkitActorsExtensionsCallbackExtension_PerformCallback *p = (ComDroidkitActorsExtensionsCallbackExtension_PerformCallback *) check_class_cast(message, [ComDroidkitActorsExtensionsCallbackExtension_PerformCallback class]);
    if (![((JavaUtilHashMap *) nil_chk(proxyMap_)) containsKeyWithId:((ComDroidkitActorsExtensionsCallbackExtension_PerformCallback *) nil_chk(p))->dest_]) {
      return YES;
    }
    @try {
      [((JavaLangReflectMethod *) nil_chk(p->method_)) invokeWithId:p->dest_ withNSObjectArray:p->args_];
    }
    @catch (JavaLangIllegalAccessException *e) {
      [((JavaLangIllegalAccessException *) nil_chk(e)) printStackTrace];
    }
    @catch (JavaLangReflectInvocationTargetException *e) {
      [((JavaLangReflectInvocationTargetException *) nil_chk(e)) printStackTrace];
    }
    return YES;
  }
  return NO;
}

- (id)proxyWithId:(id)src
     withIOSClass:(IOSClass *)tClass {
  if ([((JavaUtilHashMap *) nil_chk(proxyMap_)) containsKeyWithId:src]) {
    return (id) [proxyMap_ getWithId:src];
  }
  id res = JavaLangReflectProxy_newProxyInstanceWithJavaLangClassLoader_withIOSClassArray_withJavaLangReflectInvocationHandler_([((DAActorSystem *) nil_chk([((DAActorRef *) nil_chk(self__)) system])) getClassLoader], [IOSObjectArray arrayWithObjects:(id[]){ tClass } count:1 type:IOSClass_class_()], [[[ComDroidkitActorsExtensionsCallbackExtension_$1 alloc] initWithComDroidkitActorsExtensionsCallbackExtension:self withId:src] autorelease]);
  [proxyMap_ putWithId:src withId:res];
  return (id) res;
}

- (void)postStop {
  [((JavaUtilHashMap *) nil_chk(proxyMap_)) clear];
}

- (void)dealloc {
  RELEASE_(proxyMap_);
  RELEASE_(self__);
  [super dealloc];
}

- (void)copyAllFieldsTo:(ComDroidkitActorsExtensionsCallbackExtension *)other {
  [super copyAllFieldsTo:other];
  ComDroidkitActorsExtensionsCallbackExtension_set_proxyMap_(other, proxyMap_);
  ComDroidkitActorsExtensionsCallbackExtension_set_self__(other, self__);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithDAActorRef:", "CallbackExtension", NULL, 0x1, NULL },
    { "preStart", NULL, "V", 0x1, NULL },
    { "onReceiveWithId:", "onReceive", "Z", 0x1, NULL },
    { "proxyWithId:withIOSClass:", "proxy", "TT;", 0x1, NULL },
    { "postStop", NULL, "V", 0x1, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "proxyMap_", NULL, 0x2, "Ljava.util.HashMap;", NULL,  },
    { "self__", "self", 0x2, "Lcom.droidkit.actors.ActorRef;", NULL,  },
  };
  static const J2ObjcClassInfo _ComDroidkitActorsExtensionsCallbackExtension = { 1, "CallbackExtension", "com.droidkit.actors.extensions", NULL, 0x1, 5, methods, 2, fields, 0, NULL};
  return &_ComDroidkitActorsExtensionsCallbackExtension;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComDroidkitActorsExtensionsCallbackExtension)

@implementation ComDroidkitActorsExtensionsCallbackExtension_PerformCallback

- (instancetype)initWithId:(id)dest
 withJavaLangReflectMethod:(JavaLangReflectMethod *)method
         withNSObjectArray:(IOSObjectArray *)args {
  if (self = [super init]) {
    ComDroidkitActorsExtensionsCallbackExtension_PerformCallback_set_dest_(self, dest);
    ComDroidkitActorsExtensionsCallbackExtension_PerformCallback_set_method_(self, method);
    ComDroidkitActorsExtensionsCallbackExtension_PerformCallback_set_args_(self, args);
  }
  return self;
}

- (void)dealloc {
  RELEASE_(dest_);
  RELEASE_(method_);
  RELEASE_(args_);
  [super dealloc];
}

- (void)copyAllFieldsTo:(ComDroidkitActorsExtensionsCallbackExtension_PerformCallback *)other {
  [super copyAllFieldsTo:other];
  ComDroidkitActorsExtensionsCallbackExtension_PerformCallback_set_dest_(other, dest_);
  ComDroidkitActorsExtensionsCallbackExtension_PerformCallback_set_method_(other, method_);
  ComDroidkitActorsExtensionsCallbackExtension_PerformCallback_set_args_(other, args_);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithId:withJavaLangReflectMethod:withNSObjectArray:", "PerformCallback", NULL, 0x2, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "dest_", NULL, 0x2, "Ljava.lang.Object;", NULL,  },
    { "method_", NULL, 0x2, "Ljava.lang.reflect.Method;", NULL,  },
    { "args_", NULL, 0x2, "[Ljava.lang.Object;", NULL,  },
  };
  static const J2ObjcClassInfo _ComDroidkitActorsExtensionsCallbackExtension_PerformCallback = { 1, "PerformCallback", "com.droidkit.actors.extensions", "CallbackExtension", 0xa, 1, methods, 3, fields, 0, NULL};
  return &_ComDroidkitActorsExtensionsCallbackExtension_PerformCallback;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComDroidkitActorsExtensionsCallbackExtension_PerformCallback)

@implementation ComDroidkitActorsExtensionsCallbackExtension_$1

- (id)invokeWithId:(id)proxy
withJavaLangReflectMethod:(JavaLangReflectMethod *)method
 withNSObjectArray:(IOSObjectArray *)args {
  [((DAActorRef *) nil_chk(this$0_->self__)) sendWithId:[[[ComDroidkitActorsExtensionsCallbackExtension_PerformCallback alloc] initWithId:val$src_ withJavaLangReflectMethod:method withNSObjectArray:args] autorelease]];
  return nil;
}

- (instancetype)initWithComDroidkitActorsExtensionsCallbackExtension:(ComDroidkitActorsExtensionsCallbackExtension *)outer$
                                                              withId:(id)capture$0 {
  ComDroidkitActorsExtensionsCallbackExtension_$1_set_this$0_(self, outer$);
  ComDroidkitActorsExtensionsCallbackExtension_$1_set_val$src_(self, capture$0);
  return [super init];
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(val$src_);
  [super dealloc];
}

- (void)copyAllFieldsTo:(ComDroidkitActorsExtensionsCallbackExtension_$1 *)other {
  [super copyAllFieldsTo:other];
  ComDroidkitActorsExtensionsCallbackExtension_$1_set_this$0_(other, this$0_);
  ComDroidkitActorsExtensionsCallbackExtension_$1_set_val$src_(other, val$src_);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "invokeWithId:withJavaLangReflectMethod:withNSObjectArray:", "invoke", "Ljava.lang.Object;", 0x1, "Ljava.lang.Throwable;" },
    { "initWithComDroidkitActorsExtensionsCallbackExtension:withId:", "init", NULL, 0x0, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lcom.droidkit.actors.extensions.CallbackExtension;", NULL,  },
    { "val$src_", NULL, 0x1012, "TT;", NULL,  },
  };
  static const J2ObjcClassInfo _ComDroidkitActorsExtensionsCallbackExtension_$1 = { 1, "$1", "com.droidkit.actors.extensions", "CallbackExtension", 0x8000, 2, methods, 2, fields, 0, NULL};
  return &_ComDroidkitActorsExtensionsCallbackExtension_$1;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComDroidkitActorsExtensionsCallbackExtension_$1)
