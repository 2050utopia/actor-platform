//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/im/actor/model/modules/typing/OwnTypingActor.java
//

#include "J2ObjC_source.h"
#include "im/actor/model/api/OutPeer.h"
#include "im/actor/model/api/PeerType.h"
#include "im/actor/model/api/rpc/RequestTyping.h"
#include "im/actor/model/droidkit/actors/Actor.h"
#include "im/actor/model/droidkit/actors/ActorTime.h"
#include "im/actor/model/entity/Peer.h"
#include "im/actor/model/entity/PeerType.h"
#include "im/actor/model/entity/User.h"
#include "im/actor/model/modules/Modules.h"
#include "im/actor/model/modules/typing/OwnTypingActor.h"
#include "im/actor/model/modules/utils/ModuleActor.h"

__attribute__((unused)) static void ImActorModelModulesTypingOwnTypingActor_onTypingWithImActorModelEntityPeer_(ImActorModelModulesTypingOwnTypingActor *self, ImActorModelEntityPeer *peer);

@interface ImActorModelModulesTypingOwnTypingActor () {
 @public
  jlong lastTypingTime_;
}

- (void)onTypingWithImActorModelEntityPeer:(ImActorModelEntityPeer *)peer;
@end

@interface ImActorModelModulesTypingOwnTypingActor_Typing () {
 @public
  ImActorModelEntityPeer *peer_;
}
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesTypingOwnTypingActor_Typing, peer_, ImActorModelEntityPeer *)

@implementation ImActorModelModulesTypingOwnTypingActor

- (instancetype)initWithImActorModelModulesModules:(ImActorModelModulesModules *)messenger {
  if (self = [super initWithImActorModelModulesModules:messenger]) {
    lastTypingTime_ = 0;
  }
  return self;
}

- (void)onTypingWithImActorModelEntityPeer:(ImActorModelEntityPeer *)peer {
  ImActorModelModulesTypingOwnTypingActor_onTypingWithImActorModelEntityPeer_(self, peer);
}

- (void)onReceiveWithId:(id)message {
  if ([message isKindOfClass:[ImActorModelModulesTypingOwnTypingActor_Typing class]]) {
    ImActorModelModulesTypingOwnTypingActor_onTypingWithImActorModelEntityPeer_(self, [((ImActorModelModulesTypingOwnTypingActor_Typing *) nil_chk(((ImActorModelModulesTypingOwnTypingActor_Typing *) check_class_cast(message, [ImActorModelModulesTypingOwnTypingActor_Typing class])))) getPeer]);
  }
  else {
    [self dropWithId:message];
  }
}

- (void)copyAllFieldsTo:(ImActorModelModulesTypingOwnTypingActor *)other {
  [super copyAllFieldsTo:other];
  other->lastTypingTime_ = lastTypingTime_;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithImActorModelModulesModules:", "OwnTypingActor", NULL, 0x1, NULL },
    { "onTypingWithImActorModelEntityPeer:", "onTyping", "V", 0x2, NULL },
    { "onReceiveWithId:", "onReceive", "V", 0x1, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "TYPING_DELAY_", NULL, 0x1a, "J", NULL, .constantValue.asLong = ImActorModelModulesTypingOwnTypingActor_TYPING_DELAY },
    { "lastTypingTime_", NULL, 0x2, "J", NULL,  },
  };
  static const J2ObjcClassInfo _ImActorModelModulesTypingOwnTypingActor = { 1, "OwnTypingActor", "im.actor.model.modules.typing", NULL, 0x1, 3, methods, 2, fields, 0, NULL};
  return &_ImActorModelModulesTypingOwnTypingActor;
}

@end

void ImActorModelModulesTypingOwnTypingActor_onTypingWithImActorModelEntityPeer_(ImActorModelModulesTypingOwnTypingActor *self, ImActorModelEntityPeer *peer) {
  if (ImActorModelDroidkitActorsActorTime_currentTime() - self->lastTypingTime_ < ImActorModelModulesTypingOwnTypingActor_TYPING_DELAY) {
    return;
  }
  self->lastTypingTime_ = ImActorModelDroidkitActorsActorTime_currentTime();
  ImActorModelApiOutPeer *outPeer;
  if ([((ImActorModelEntityPeer *) nil_chk(peer)) getPeerType] == ImActorModelEntityPeerTypeEnum_get_PRIVATE()) {
    ImActorModelEntityUser *user = [self getUserWithInt:[peer getPeerId]];
    if (user == nil) {
      return;
    }
    outPeer = [[ImActorModelApiOutPeer alloc] initWithImActorModelApiPeerTypeEnum:ImActorModelApiPeerTypeEnum_get_PRIVATE() withInt:[((ImActorModelEntityUser *) nil_chk(user)) getUid] withLong:[user getAccessHash]];
  }
  else if ([peer getPeerType] == ImActorModelEntityPeerTypeEnum_get_GROUP()) {
    return;
  }
  else {
    return;
  }
  [self requestWithImActorModelNetworkParserRequest:[[ImActorModelApiRpcRequestTyping alloc] initWithImActorModelApiOutPeer:outPeer withInt:0]];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesTypingOwnTypingActor)

@implementation ImActorModelModulesTypingOwnTypingActor_Typing

- (instancetype)initWithImActorModelEntityPeer:(ImActorModelEntityPeer *)peer {
  if (self = [super init]) {
    self->peer_ = peer;
  }
  return self;
}

- (ImActorModelEntityPeer *)getPeer {
  return peer_;
}

- (void)copyAllFieldsTo:(ImActorModelModulesTypingOwnTypingActor_Typing *)other {
  [super copyAllFieldsTo:other];
  other->peer_ = peer_;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithImActorModelEntityPeer:", "Typing", NULL, 0x1, NULL },
    { "getPeer", NULL, "Lim.actor.model.entity.Peer;", 0x1, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "peer_", NULL, 0x2, "Lim.actor.model.entity.Peer;", NULL,  },
  };
  static const J2ObjcClassInfo _ImActorModelModulesTypingOwnTypingActor_Typing = { 1, "Typing", "im.actor.model.modules.typing", "OwnTypingActor", 0x9, 2, methods, 1, fields, 0, NULL};
  return &_ImActorModelModulesTypingOwnTypingActor_Typing;
}

@end

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesTypingOwnTypingActor_Typing)
