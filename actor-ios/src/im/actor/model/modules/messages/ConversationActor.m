//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-model/actor-ios/build/java/im/actor/model/modules/messages/ConversationActor.java
//

#include "J2ObjC_source.h"
#include "com/droidkit/actors/ActorRef.h"
#include "im/actor/model/Messenger.h"
#include "im/actor/model/entity/Message.h"
#include "im/actor/model/entity/Peer.h"
#include "im/actor/model/modules/Messages.h"
#include "im/actor/model/modules/messages/ConversationActor.h"
#include "im/actor/model/modules/messages/DialogsActor.h"
#include "im/actor/model/mvvm/ListEngine.h"

__attribute__((unused)) static void ImActorModelModulesMessagesConversationActor_onInMessageWithImActorModelEntityMessage_(ImActorModelModulesMessagesConversationActor *self, ImActorModelEntityMessage *message);

@interface ImActorModelModulesMessagesConversationActor () {
 @public
  AMMessenger *messenger_;
  ImActorModelEntityPeer *peer_;
  id<ImActorModelMvvmListEngine> messages_;
  DAActorRef *dialogsActor_;
}

- (void)onInMessageWithImActorModelEntityMessage:(ImActorModelEntityMessage *)message;
@end

J2OBJC_FIELD_SETTER(ImActorModelModulesMessagesConversationActor, messenger_, AMMessenger *)
J2OBJC_FIELD_SETTER(ImActorModelModulesMessagesConversationActor, peer_, ImActorModelEntityPeer *)
J2OBJC_FIELD_SETTER(ImActorModelModulesMessagesConversationActor, messages_, id<ImActorModelMvvmListEngine>)
J2OBJC_FIELD_SETTER(ImActorModelModulesMessagesConversationActor, dialogsActor_, DAActorRef *)

@implementation ImActorModelModulesMessagesConversationActor

- (instancetype)initWithImActorModelEntityPeer:(ImActorModelEntityPeer *)peer
                               withAMMessenger:(AMMessenger *)messenger {
  if (self = [super init]) {
    ImActorModelModulesMessagesConversationActor_set_peer_(self, peer);
    ImActorModelModulesMessagesConversationActor_set_messenger_(self, messenger);
  }
  return self;
}

- (void)preStart {
  ImActorModelModulesMessagesConversationActor_set_messages_(self, [((AMMessenger *) nil_chk(messenger_)) getMessagesWithImActorModelEntityPeer:peer_]);
  ImActorModelModulesMessagesConversationActor_set_dialogsActor_(self, [((ImActorModelModulesMessages *) nil_chk([messenger_ getMessagesModule])) getDialogsActor]);
}

- (void)onReceiveWithId:(id)message {
  if ([message isKindOfClass:[ImActorModelEntityMessage class]]) {
    ImActorModelModulesMessagesConversationActor_onInMessageWithImActorModelEntityMessage_(self, (ImActorModelEntityMessage *) check_class_cast(message, [ImActorModelEntityMessage class]));
  }
}

- (void)onInMessageWithImActorModelEntityMessage:(ImActorModelEntityMessage *)message {
  ImActorModelModulesMessagesConversationActor_onInMessageWithImActorModelEntityMessage_(self, message);
}

- (void)dealloc {
  RELEASE_(messenger_);
  RELEASE_(peer_);
  RELEASE_(messages_);
  RELEASE_(dialogsActor_);
  [super dealloc];
}

- (void)copyAllFieldsTo:(ImActorModelModulesMessagesConversationActor *)other {
  [super copyAllFieldsTo:other];
  ImActorModelModulesMessagesConversationActor_set_messenger_(other, messenger_);
  ImActorModelModulesMessagesConversationActor_set_peer_(other, peer_);
  ImActorModelModulesMessagesConversationActor_set_messages_(other, messages_);
  ImActorModelModulesMessagesConversationActor_set_dialogsActor_(other, dialogsActor_);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithImActorModelEntityPeer:withAMMessenger:", "ConversationActor", NULL, 0x1, NULL },
    { "preStart", NULL, "V", 0x1, NULL },
    { "onReceiveWithId:", "onReceive", "V", 0x1, NULL },
    { "onInMessageWithImActorModelEntityMessage:", "onInMessage", "V", 0x2, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "messenger_", NULL, 0x2, "Lim.actor.model.Messenger;", NULL,  },
    { "peer_", NULL, 0x2, "Lim.actor.model.entity.Peer;", NULL,  },
    { "messages_", NULL, 0x2, "Lim.actor.model.mvvm.ListEngine;", NULL,  },
    { "dialogsActor_", NULL, 0x2, "Lcom.droidkit.actors.ActorRef;", NULL,  },
  };
  static const J2ObjcClassInfo _ImActorModelModulesMessagesConversationActor = { 1, "ConversationActor", "im.actor.model.modules.messages", NULL, 0x1, 4, methods, 4, fields, 0, NULL};
  return &_ImActorModelModulesMessagesConversationActor;
}

@end

void ImActorModelModulesMessagesConversationActor_onInMessageWithImActorModelEntityMessage_(ImActorModelModulesMessagesConversationActor *self, ImActorModelEntityMessage *message) {
  if ([((id<ImActorModelMvvmListEngine>) nil_chk(self->messages_)) getValueWithLong:[((ImActorModelEntityMessage *) nil_chk(message)) getListId]] != nil) {
    return;
  }
  [self->messages_ addOrUpdateItemWithImActorModelMvvmListEngineItem:message];
  [((DAActorRef *) nil_chk(self->dialogsActor_)) sendWithId:[[[ImActorModelModulesMessagesDialogsActor_InMessage alloc] initWithImActorModelEntityPeer:self->peer_ withImActorModelEntityMessage:message] autorelease]];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ImActorModelModulesMessagesConversationActor)
